<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Python: module kmer_counter</title>
</head><body>

<table class="heading">
<tr class="heading-text decor">
<td class="title">&nbsp;<br><strong class="title">kmer_counter</strong></td>
<td class="extra"><a href=".">index</a><br><a href="file:/home/rennig/Dokumente/k-mer/bin/kmer_counter.py">/home/rennig/Dokumente/k-mer/bin/kmer_counter.py</a></td></tr></table>
    <p><span class="code">kmer_counter.py<br>
&nbsp;<br>
This&nbsp;script&nbsp;focuses&nbsp;on&nbsp;the&nbsp;efficient&nbsp;counting&nbsp;of&nbsp;k-mers&nbsp;from&nbsp;DNA&nbsp;sequences&nbsp;and&nbsp;provides&nbsp;functionality&nbsp;for&nbsp;generating&nbsp;k-mer&nbsp;count&nbsp;dictionaries.<br>
It&nbsp;supports&nbsp;both&nbsp;single-sequence&nbsp;and&nbsp;multi-sequence&nbsp;processing.<br>
&nbsp;<br>
Functions:<br>
&nbsp;&nbsp;&nbsp;&nbsp;count_kmers(sequence:&nbsp;str,&nbsp;k:&nbsp;int)&nbsp;-&gt;&nbsp;dict:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Counts&nbsp;k-mers&nbsp;of&nbsp;length&nbsp;`k`&nbsp;in&nbsp;a&nbsp;given&nbsp;DNA&nbsp;sequence&nbsp;and&nbsp;returns&nbsp;a&nbsp;dictionary&nbsp;where&nbsp;keys&nbsp;are&nbsp;k-mers&nbsp;and&nbsp;values&nbsp;are&nbsp;their&nbsp;counts.<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;merge_kmer_counts(kmer_dicts:&nbsp;list[dict])&nbsp;-&gt;&nbsp;dict:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Merges&nbsp;multiple&nbsp;k-mer&nbsp;count&nbsp;dictionaries&nbsp;into&nbsp;a&nbsp;single&nbsp;dictionary,&nbsp;summing&nbsp;the&nbsp;counts&nbsp;for&nbsp;any&nbsp;overlapping&nbsp;k-mers.<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;write_kmer_counts_to_file(kmer_counts:&nbsp;dict,&nbsp;output_file:&nbsp;str):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Writes&nbsp;the&nbsp;k-mer&nbsp;counts&nbsp;to&nbsp;a&nbsp;file&nbsp;in&nbsp;TSV&nbsp;format,&nbsp;with&nbsp;one&nbsp;k-mer&nbsp;and&nbsp;its&nbsp;count&nbsp;per&nbsp;line.<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;process_fasta_file(fasta_path:&nbsp;str,&nbsp;k:&nbsp;int)&nbsp;-&gt;&nbsp;dict:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Processes&nbsp;a&nbsp;FASTA&nbsp;file,&nbsp;counts&nbsp;k-mers&nbsp;for&nbsp;each&nbsp;sequence,&nbsp;and&nbsp;returns&nbsp;a&nbsp;dictionary&nbsp;of&nbsp;k-mer&nbsp;counts.<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;kmer_counter_from_fasta_paths(fasta_paths:&nbsp;list[str],&nbsp;k:&nbsp;int,&nbsp;output_dir:&nbsp;str):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Iterates&nbsp;over&nbsp;multiple&nbsp;FASTA&nbsp;files,&nbsp;computes&nbsp;k-mer&nbsp;counts&nbsp;for&nbsp;each,&nbsp;and&nbsp;saves&nbsp;them&nbsp;in&nbsp;TSV&nbsp;format.<br>
&nbsp;<br>
Main&nbsp;Execution:<br>
&nbsp;&nbsp;&nbsp;&nbsp;Command-line&nbsp;arguments:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;fasta_paths&nbsp;(list&nbsp;of&nbsp;str):&nbsp;List&nbsp;of&nbsp;paths&nbsp;to&nbsp;the&nbsp;FASTA&nbsp;files&nbsp;to&nbsp;be&nbsp;processed.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;k&nbsp;(int):&nbsp;Length&nbsp;of&nbsp;k-mers&nbsp;to&nbsp;be&nbsp;counted.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;output_dir&nbsp;(str):&nbsp;Directory&nbsp;where&nbsp;k-mer&nbsp;count&nbsp;TSV&nbsp;files&nbsp;will&nbsp;be&nbsp;saved.<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Workflow:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;Read&nbsp;DNA&nbsp;sequences&nbsp;from&nbsp;FASTA&nbsp;files.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;Count&nbsp;k-mers&nbsp;for&nbsp;each&nbsp;sequence.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;Save&nbsp;the&nbsp;results&nbsp;to&nbsp;the&nbsp;specified&nbsp;output&nbsp;directory&nbsp;in&nbsp;TSV&nbsp;format.</span></p>
<p>
<table class="section">
<tr class="decor pkg-content-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Modules</strong></td></tr>
    
<tr><td class="decor pkg-content-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><table><tr><td class="multicolumn"><a href="json.html">json</a><br>
<a href="numpy.html">numpy</a><br>
</td><td class="multicolumn"><a href="os.html">os</a><br>
<a href="pandas.html">pandas</a><br>
</td><td class="multicolumn"><a href="sys.html">sys</a><br>
</td><td class="multicolumn"></td></tr></table></td></tr></table><p>
<table class="section">
<tr class="decor functions-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Functions</strong></td></tr>
    
<tr><td class="decor functions-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><dl><dt><a name="-count_sequence_length"><strong>count_sequence_length</strong></a>(sequences_by_species, output_dir_seq)</dt><dd><span class="code">Calculates&nbsp;the&nbsp;total&nbsp;sequence&nbsp;length&nbsp;for&nbsp;each&nbsp;input&nbsp;file.<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;sequences_by_species&nbsp;(list):&nbsp;List&nbsp;of&nbsp;dictionaries&nbsp;with&nbsp;"filename"&nbsp;and&nbsp;"sequences"&nbsp;keys.<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;sequence_lengths&nbsp;(dict):&nbsp;Dictionary&nbsp;with&nbsp;filenames&nbsp;as&nbsp;keys&nbsp;and&nbsp;total&nbsp;sequence&nbsp;lengths&nbsp;as&nbsp;values.</span></dd></dl>
 <dl><dt><a name="-kmer_counter"><strong>kmer_counter</strong></a>(sequence, k)</dt><dd><span class="code">Counts&nbsp;k-mers&nbsp;of&nbsp;defined&nbsp;length&nbsp;and&nbsp;stores&nbsp;counts&nbsp;in&nbsp;a&nbsp;dictionary.<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;input&nbsp;sequence&nbsp;(str)<br>
&nbsp;&nbsp;&nbsp;&nbsp;k&nbsp;(str):&nbsp;k-mer&nbsp;length<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;kmer_count&nbsp;(dict):&nbsp;{k-mer:&nbsp;count}</span></dd></dl>
 <dl><dt><a name="-kmer_counter_multi_input"><strong>kmer_counter_multi_input</strong></a>(input_list, k_values, output_dir)</dt><dd><span class="code">Counts&nbsp;k-mers&nbsp;for&nbsp;multiple&nbsp;input&nbsp;files&nbsp;and&nbsp;generates&nbsp;k-mer&nbsp;count&nbsp;contingency&nbsp;tables.<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;input_list&nbsp;(list&nbsp;of&nbsp;lists):&nbsp;containing&nbsp;one&nbsp;list&nbsp;per&nbsp;input&nbsp;file&nbsp;which&nbsp;in&nbsp;turn&nbsp;contain&nbsp;all&nbsp;sequences&nbsp;of&nbsp;input&nbsp;file<br>
&nbsp;&nbsp;&nbsp;&nbsp;k_values&nbsp;(list):&nbsp;list&nbsp;of&nbsp;k-mer&nbsp;lengths<br>
&nbsp;&nbsp;&nbsp;&nbsp;table_inclusion_threshold&nbsp;(int):&nbsp;minimal&nbsp;k-mer&nbsp;frequency&nbsp;per&nbsp;cell&nbsp;for&nbsp;column&nbsp;to&nbsp;be&nbsp;included&nbsp;in&nbsp;contingency&nbsp;table<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.tsv&nbsp;files&nbsp;containing&nbsp;contingency&nbsp;table&nbsp;for&nbsp;each&nbsp;k-mer&nbsp;length</span></dd></dl>
</td></tr></table>
</body></html>